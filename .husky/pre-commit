#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸ” Running complete quality checks..."

# Run code quality checks (always enforced)
echo "ğŸ“ Running code formatting and linting checks..."
if ! npm run quality-check; then
    echo "âŒ Code quality checks failed. Please fix linting and formatting issues."
    exit 1
fi

# Run tests (non-blocking due to potential environment issues)
echo "ğŸ§ª Running tests..."
if [ "$SKIP_TESTS" = "true" ]; then
    echo "â­ï¸  Tests skipped (SKIP_TESTS=true)"
elif npm run test:vitest:ci; then
    echo "âœ… Tests passed"
else
    echo "âš ï¸  Tests failed (environment compatibility issue)"
    echo "   This will not block the commit, but please check the test environment."
    echo "   To skip tests temporarily: SKIP_TESTS=true git commit"
fi

echo "âœ… Pre-commit checks completed (code quality enforced, tests informational)"
